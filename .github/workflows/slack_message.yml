name: Notify Slack on Issue Events

on:
  issues:
    types: [opened, edited, closed]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send notification to Slack
        uses: actions/github-script@v6
        with:
          script: |
            const { HttpClient } = require('@actions/http-client');

            const issue = context.payload.issue;
            const event = context.eventName;
            const webhookUrl = process.env.SLACK_WEBHOOK_URL;

            const message = {
              text: `Issue ${event}: *${issue.title}* - ${issue.html_url}`,
              channel: '#your-channel', // Replace with your channel name
              username: 'GitHub Issues Bot',
            };

            const http = new HttpClient();
            http.post(webhookUrl, JSON.stringify(message), {
              headers: { 'Content-Type': 'application/json' }
            }).then(response => {
              if (response.message.statusCode === 200) {
                console.log('Notification sent successfully');
              } else {
                console.error('Failed to send notification');
              }
            }).catch(error => {
              console.error('Error:', error);
            });
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
